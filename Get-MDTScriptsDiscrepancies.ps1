Function Get-MDTScriptsDiscrepancies {
 param ([string]$ScriptsPath = $PWD)

$defaultFiles = @(
    "Autorun.inf",
    "BackButton.JPG",
    "BackButton.PNG",
    "BDD_Autorun.wsf",
    "BDD_Welcome_ENU.xml",
    "btnout.png",
    "btnover.png",
    "btnsel.png",
    "Computer.png",
    "Create.png",
    "Credentials_ENU.xml",
    "Credentials_scripts.vbs",
    "Delete.png",
    "DeployWiz_AdminAccounts.xml",
    "DeployWiz_Administrator.png",
    "DeployWiz_AdminPassword.vbs",
    "DeployWiz_AdminPassword.xml",
    "DeployWiz_Applications.vbs",
    "DeployWiz_Applications.xml",
    "DeployWiz_BitLocker.vbs",
    "DeployWiz_BitLocker.xml",
    "DeployWiz_CaptureImage.vbs",
    "DeployWiz_CaptureImage.xml",
    "DeployWiz_Computer.png",
    "DeployWiz_ComputerBackup.vbs",
    "DeployWiz_ComputerBackup.xml",
    "DeployWiz_ComputerName.vbs",
    "DeployWiz_ComputerName.xml",
    "DeployWiz_Credentials.png",
    "DeployWiz_Credentials.vbs",
    "DeployWiz_Credentials.xml",
    "DeployWiz_Definition_ENU.xml",
    "DeployWiz_Initialization.vbs",
    "DeployWiz_Language.png",
    "DeployWiz_LanguagePack.vbs",
    "DeployWiz_LanguagePack.xml",
    "DeployWiz_LanguageUI.vbs",
    "DeployWiz_LanguageUI.xml",
    "DeployWiz_Network.png",
    "DeployWiz_OfflineData.vbs",
    "DeployWiz_OfflineData.xml",
    "DeployWiz_ProductKeyVista.vbs",
    "DeployWiz_ProductKeyVista.xml",
    "DeployWiz_Ready.vbs",
    "DeployWiz_Ready.xml",
    "DeployWiz_Roles.vbs",
    "DeployWiz_Roles.xml",
    "DeployWiz_Roles.xsl",
    "DeployWiz_SelectTS.vbs",
    "DeployWiz_SelectTS.xml",
    "DeployWiz_TimeZone.png",
    "DeployWiz_UserData.vbs",
    "DeployWiz_UserData.xml",
    "DeployWiz_UserDataRestore.vbs",
    "DeployWiz_UserDataRestore.xml",
    "DeployWiz_Validation.vbs",
    "Extend.png",
    "FolderIcon.png",
    "Format.png",
    "header-image.png",
    "ItemIcon1.png",
    "ListOfLanguages.xml",
    "LiteTouch.vbs",
    "LiteTouch.wsf",
    "LTIApply.wsf",
    "LTIBootstrap.vbs",
    "LTICleanup.wsf",
    "LTICopyScripts.wsf",
    "LTIGetFolder.wsf",
    "LTIOEM.wsf",
    "LTISuspend.wsf",
    "LTISysprep.wsf",
    "LTITriggerUpgradeFailure.wsf",
    "minusico.gif",
    "MinusIcon1.png",
    "NavBar.png",
    "NICSettings_Definition_ENU.xml",
    "OSDBranding.vbs",
    "OSDBrandingx64.vbs",
    "OSDEndTime.vbs",
    "OSDLocalAdmins.vbs",
    "OSDProgress.vbs",
    "OSD_BaseVariables.vbs",
    "plusicon.gif",
    "PlusIcon1.png",
    "Refresh.png",
    "SelectItem.jpg",
    "SelectItem.png",
    "ServerManager.xml",
    "SetupComplete.cmd",
    "SetupRollback.cmd",
    "Summary_Definition_ENU.xml",
    "Summary_scripts.vbs",
    "UDIoffline.xml",
    "UDIWizard.wsf",
    "UDIWizard_Config.xml",
    "UDIWizard_Config.xml.app",
    "WelcomeBanner.jpg",
    "WelcomeWiz_Background.jpg",
    "WelcomeWiz_Choice.vbs",
    "WelcomeWiz_Choice.xml",
    "WelcomeWiz_DeployRoot.vbs",
    "WelcomeWiz_DeployRoot.xml",
    "WelcomeWiz_Initialize.vbs",
    "WelcomeWiz_Initialize.xml",
    "Wizard.css",
    "Wizard.hta",
    "Wizard.ico",
    "WizUtility.vbs",
    "ZTIApplications.wsf",
    "ZTIApplyGPOPack.wsf",
    "ZTIAppXmlGen.wsf",
    "ZTIAuthorizeDHCP.wsf",
    "ZTIBackup.wsf",
    "ZTIBCDUtility.vbs",
    "ZTIBde.wsf",
    "ZTIBIOSCheck.wsf",
    "ZTIBIOSCheck.xml",
    "ZTICoalesce.wsf",
    "ZTIConfigFile.vbs",
    "ZTIConfigure.wsf",
    "ZTIConfigure.xml",
    "ZTIConfigureADDS.wsf",
    "ZTIConfigureDHCP.wsf",
    "ZTIConfigureDNS.wsf",
    "ZTIConfirmDiskpart.vbs",
    "ZTIConnect.wsf",
    "ZTICopyLogs.wsf",
    "ZTIDataAccess.vbs",
    "ZTIDisableBDEProtectors.wsf",
    "ZTIDiskpart.wsf",
    "ZTIDiskUtility.vbs",
    "ZTIDomainJoin.wsf",
    "ZTIDone.wsf",
    "ZTIDrivers.wsf",
    "ZTIErrorMsg.wsf",
    "ZTIExecuteRunbook.wsf",
    "ZTIGather.wsf",
    "ZTIGather.xml",
    "ZTIGroups.wsf",
    "ZTILangPacksOnline.wsf",
    "ZTIModifyVol.wsf",
    "ZTIMoveStateStore.wsf",
    "ZTINextPhase.wsf",
    "ZTINICConfig.wsf",
    "ZTINicUtility.vbs",
    "ZTIOptIn.wsf",
    "ZTIOSRole.wsf",
    "ZTIOSRolePS.ps1",
    "ZTIPatches.wsf",
    "ZTIPowerShell.wsf",
    "ZTIPrereq.vbs",
    "ZTIPSUtility.vbs",
    "ztiRunCommandHidden.wsf",
    "ZTISCCM.wsf",
    "ZTISetBackground.wsf",
    "ZTISetupRollback.wsf",
    "ZTISetVariable.wsf",
    "ZTISupportedPlatforms.xml",
    "ZTITatoo.mof",
    "ZTITatoo.wsf",
    "ZTIUserState.wsf",
    "ZTIUserState_Config.xml",
    "ZTIUtility.vbs",
    "ZTIValidate.wsf",
    "ZTIVHDCreate.wsf",
    "ZTIWindowsUpdate.wsf",
    "ZTIWinRE.wsf",
    "ZTIWipeDisk.wsf"
)


$mdtScriptsFolder = $ScriptsPath
$mdtFiles = Get-ChildItem -Path $mdtScriptsFolder -File | Select-Object -ExpandProperty Name
$missingFiles = Compare-Object -ReferenceObject $defaultFiles -DifferenceObject $mdtFiles | Where-Object { $_.SideIndicator -eq '=>' }

if ($missingFiles) {
    Write-Host
    Write-Host "The following files are additional to the default files in the scripts folder" -ForegroundColor "Green"
    $missingFiles | ForEach-Object {
        Write-Host "- $($_.InputObject)"
    }
} else {
    Write-Host "No missing files found in the MDT scripts folder."
}

Write-Host

}

Get-MDTScriptsDiscrepancies -ScriptsPath \\MDTServer\DeploymentShare$\Scripts
