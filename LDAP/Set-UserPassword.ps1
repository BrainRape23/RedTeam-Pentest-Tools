function SetUserPassword {

<#
.SYNOPSIS
Changes the password for a specified user in a domain.

.DESCRIPTION
This function changes the password for a user in the specified Active Directory domain. If no domain is specified, it uses the domain of the current user. It requires the user's current domain, username, and the new password.

.PARAMETER Domain
The domain of the user. If not specified, the domain of the current user is used.

.PARAMETER User
The username of the account for which the password will be changed.

.PARAMETER Password
The new password to be set for the user.


.EXAMPLE
SetUserPassword -User "Mendez" -Password "Password123"

This example changes the password for the user "Mendez" in the current user's domain to "Password123".

#>

    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$false)]
        [string]$Domain = $env:USERDNSDOMAIN,

        [Parameter(Mandatory=$true)]
        [string]$User,

        [Parameter(Mandatory=$true)]
        [string]$Password

    )

    $adsiPath = "WinNT://$Domain/$User,user"

    try {
        $userObj = [ADSI]$adsiPath

        $userObj.SetPassword($Password)
        $userObj.SetInfo()

        Write-Host
        Write-Host "[+] " -ForegroundColor Green -NoNewline
        Write-Host "Password changed successfully for user $User"
    
    } catch {
        
        Write-Host
        Write-Host "[-] " -ForegroundColor Red -NoNewline
        Write-Host $_ 
    }
}
